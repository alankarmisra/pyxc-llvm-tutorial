# RUN: %pyxc -i %s > %t 2>&1
# RUN: grep -q "2026.000000" %t
# RUN: grep -q "720.000000" %t
# RUN: grep -q "6.000000" %t
# RUN: grep -q "25.000000" %t
# RUN: grep -q "19.000000" %t
# RUN: grep -q "1.000000" %t
# RUN: ! grep -q "Error (Line:" %t

extern def printd(x)
extern def putchard(char)

# unary not
@unary
def !(v):
    if v:
        return 0
    else:
        return 1

# unary negate
@unary
def -(v):
    return 0 - v

# Define > with the same precedence as <
@binary(precedence=10)
def >(LHS, RHS):
    return RHS < LHS

# Logical or (no short-circuit)
@binary(precedence=5)
def |(LHS, RHS):
    if LHS:
        return 1
    else:
        if RHS:
            return 1
        else:
            return 0

# Logical and (no short-circuit)
@binary(precedence=6)
def &(LHS, RHS):
    if !LHS:
        return 0
    else:
        return !!RHS

def eq(a, b):
    return !(a < b | a > b)

def divisible(n, d):
    if n < d:
        return 0
    else:
        if eq(n, d):
            return 1
        else:
            return divisible(n - d, d)

def isprimefrom(n, d):
    if d * d > n:
        return 1
    else:
        if divisible(n, d):
            return 0
        else:
            return isprimefrom(n, d + 1)

def isprime(n):
    if n < 2:
        return 0
    else:
        return isprimefrom(n, 2)

def fact(n):
    if n < 2:
        return 1
    else:
        return n * fact(n - 1)

def gcd(a, b):
    if eq(a, b):
        return a
    else:
        if a > b:
            return gcd(a - b, b)
        else:
            return gcd(a, b - a)

def sumsq(a, b):
    return var x = a, y = b in x * x + y * y

def printtriangle(rows):
    for r in range(1, rows + 1, 1):
        for c in range(0, r, 1):
            putchard(42)
        putchard(10)
    return 0

def printprimes(limit):
    for n in range(2, limit, 1):
        if isprime(n):
            printd(n)
        else:
            0
    return 0

def demo():
    printd(2026)          # marker
    printd(fact(6))       # 720
    printd(gcd(84, 30))   # 6
    printd(sumsq(3, 4))   # 25
    printprimes(20)      # 2,3,5,7,11,13,17,19
    printd(isprime(19) & !isprime(20))  # 1
    printtriangle(6)
    return 0

demo()
